%************************************************

\chapter{LIP Filter RQs}

\label{app:lipfilter}
%************************************************

The following is a summary of the \ac{LIP} Filter \ac{RQ}s. Several  exisiting \ac{LUX} \ac{RQ}s are kept and saved as-is, along with several new \ac{RQ}s. 

The \ac{RQ}s kept from Run03 are:

\begin{Verbatim}[fontsize=\footnotesize]
run03_rq_list_to_keep = [
file_number
luxstamp_samples
x_corrected
y_corrected
pulse_classification
z_drift_samples
x_cm
y_cm

sd_radius_inf
sd_radius_sup
sd_phiXR
n_samples_in_evt

pulse_area_phe
z_corrected_pulse_area_all_phe
z_corrected_pulse_area_bot_phe
xyz_corrected_pulse_area_all_phe
xyz_corrected_pulse_area_bot_phe
top_bottom_asymmetry

pulse_classification
full_evt_area_phe
s1s2_pairing
prompt_fraction_tlx
pulse_start_samples
pulse_end_samples
pulse_length_samples
s2filter_max_s2_area
s2filter_max_s1_area

aft_t0_samples
aft_t1_samples
aft_t2_samples
hft_t1_samples
]}
\end{Verbatim}

The \ac{LIP} \ac{RQ}s generated by the \ac{LIP} filter are as follows. The shape of the \ac{RQ} is noted, along with type. All \ac{RQ}s use -999 as the initialization value. 


\begin{Verbatim}[fontsize=\footnotesize]
def lip_rqs(nEvents, nPulses):
dict_lip_rqs = \{

#RQs about Pulse Area
sumAllPulsePA :  (nEvents,) float
#S2 Pulse Area
sumCorrS2PA :  (nEvents,) float 
firstCorrS2PA :  (nEvents,) float
lastCorrS2PA :  (nEvents,) float
maxCorrS2PA :  (nEvents,) float
minCorrS2PA :  (nEvents,) float
first2CorrS2PA :  (nEvents,) float
last2CorrS2PA :  (nEvents,) float

sumCorrS2PA_xyz_corr :  (nEvents,) float 
firstCorrS2PA_xyz_corr :  (nEvents,) float
lastCorrS2PA_xyz_corr :  (nEvents,) float
maxCorrS2PA_xyz_corr :  (nEvents,) float
minCorrS2PA_xyz_corr :  (nEvents,) float
first2CorrS2PA_xyz_corr :  (nEvents,) float
last2CorrS2PA_xyz_corr :  (nEvents,) float

sumCorrS2PA_xyz_corr_bot :  (nEvents,) float 
firstCorrS2PA_xyz_corr_bot :  (nEvents,) float
lastCorrS2PA_xyz_corr_bot :  (nEvents,) float
maxCorrS2PA_xyz_corr_bot :  (nEvents,) float
minCorrS2PA_xyz_corr_bot :  (nEvents,) float
first2CorrS2PA_xyz_corr_bot :  (nEvents,) float
last2CorrS2PA_xyz_corr_bot :  (nEvents,) float

sumRawS2likePA :  (nEvents,) float 
firstRawS2likePA :  (nEvents,) float
lastRawS2likePA :  (nEvents,) float
maxRawS2likePA :  (nEvents,) float
minRawS2likePA :  (nEvents,) float
first2RawS2likePA :  (nEvents,) float
last2RawS2likePA :  (nEvents,) float

sumRawS2PA :  (nEvents,) float 
firstRawS2PA :  (nEvents,) float
lastRawS2PA :  (nEvents,) float
maxRawS2PA :  (nEvents,) float
minRawS2PA :  (nEvents,) float
first2RawS2PA :  (nEvents,) float
last2RawS2PA :  (nEvents,) float

cumSumCorrS2PA : (nEvents,nPulses) float
cumSumCorrS2PA_xyz_corr : (nEvents,nPulses) float
cumSumCorrS2PA_xyz_corr_bot : (nEvents,nPulses) float
cumSumRawS2PA : (nEvents,nPulses) float
cumSumRawS2likePA : (nEvents,nPulses) float

stdCorrS2PA :  (nEvents,) float
stdCorrS2PA_xyz_corr :  (nEvents,) float
stdCorrS2PA_xyz_corr_bot :  (nEvents,) float
stdRawS2PA :  (nEvents,) float
stdRawS2likePA :  (nEvents,) float

maxZScoreCorrS2PA :  (nEvents,) float
maxZScoreCorrS2PA_xyz_corr :  (nEvents,) float
maxZScoreCorrS2PA_xyz_corr_bot :  (nEvents,) float
maxZScoreRawS2PA :  (nEvents,) float
maxZScoreRawS2likePA :  (nEvents,) float

minZScoreCorrS2PA :  (nEvents,) float
minZScoreCorrS2PA_xyz_corr :  (nEvents,) float
minZScoreCorrS2PA_xyz_corr_bot :  (nEvents,) float
minZScoreRawS2PA :  (nEvents,) float
minZScoreRawS2likePA :  (nEvents,) float

#S1 Pulse Area
firstS1PA :  (nEvents,) float
sumAllS1PA :  (nEvents,) float
largestS1PA :  (nEvents,) float

#Amount of pulse area before the first S1
PAbeforeFirstS1 :  (nEvents,) float

#RQs about numbers of pulses
nCorrS2FitPoints : (nEvents,) int 
nRawS2FitPoints : (nEvents,) int 
nRawS2likeFitPoints : (nEvents,) int 
nS1 : (nEvents,) int

#Track RQs
#from fitting
#regular "chi2" fit
corrS2Chi2 :  (nEvents,) float
corrS2Chi2_dof :  (nEvents,) float

rawS2Chi2 :  (nEvents,) float
rawS2Chi2_dof :  (nEvents,) float

rawS2likeChi2 :  (nEvents,) float
rawS2likeChi2_dof :  (nEvents,) float

corrS2TrackFit_params :  (nEvents,6) float
rawS2TrackFit_params :  (nEvents,6) float
rawS2likeTrackFit_params :  (nEvents,6) float

#angle and distance penalty "chi2" fit
corrS2Chi2_anglePen :  (nEvents,) float
corrS2Chi2_anglePen_dof :  (nEvents,) float

rawS2Chi2_anglePen :  (nEvents,) float
rawS2Chi2_anglePen_dof :  (nEvents,) float

rawS2likeChi2_anglePen :  (nEvents,) float
rawS2likeChi2_anglePen_dof :  (nEvents,) float

corrS2TrackFit_anglePen_params :  (nEvents,6) float
rawS2TrackFit_anglePen_params :  (nEvents,6) float
rawS2likeTrackFit_anglePen_params :  (nEvents,6) float     

#Single value decomposition result 
#(used to provide an initial guess to the fits)
corrS2SVD_params :  (nEvents,6) float
rawS2SVD_params :  (nEvents,6) float
rawS2likeSVD_params :  (nEvents,6) float

#theta and phi of the track
corrS2TrackTheta :  (nEvents,) float 
corrS2TrackPhi :  (nEvents,) float 

rawS2TrackTheta :  (nEvents,) float 
rawS2TrackPhi :  (nEvents,) float

rawS2likeTrackTheta :  (nEvents,) float 
rawS2likeTrackPhi :  (nEvents,) float

corrS2TrackTheta_anglePen :  (nEvents,) float 
corrS2TrackPhi_anglePen :  (nEvents,) float 

rawS2TrackTheta_anglePen :  (nEvents,) float 
rawS2TrackPhi_anglePen :  (nEvents,) float 

rawS2likeTrackTheta_anglePen :  (nEvents,) float 
rawS2likeTrackPhi_anglePen :  (nEvents,) float 

#entrance and exit points of the track
corrS2TrackEnter :  (nEvents,3), float 
corrS2TrackExit :  (nEvents,3), float 
rawS2TrackEnter :  (nEvents,3), float 
rawS2TrackExit :  (nEvents,3), float
rawS2likeTrackEnter :  (nEvents,3), float 
rawS2likeTrackExit :  (nEvents,3), float

corrS2TrackEnter_anglePen :  (nEvents,3), float 
corrS2TrackExit_anglePen :  (nEvents,3), float 
rawS2TrackEnter_anglePen :  (nEvents,3), float 
rawS2TrackExit_anglePen :  (nEvents,3), float
rawS2likeTrackEnter_anglePen :  (nEvents,3), float
rawS2likeTrackExit_anglePen :  (nEvents,3), float

#Track length of the fits
corrS2Lfit :  (nEvents,) float 
rawS2Lfit :  (nEvents,) float
rawS2likeLfit :  (nEvents,) float
corrS2Lfit_anglePen :  (nEvents,) float 
rawS2Lfit_anglePen :  (nEvents,) float
rawS2likeLfit_anglePen :  (nEvents,) float

#angle between "Data direction" and fit track direction
corrS2DataToFitAng :  (nEvents,) float 
rawS2DataToFitAng :  (nEvents,) float 
rawS2likeDataToFitAng :  (nEvents,) float 

corrS2DataToFitAng_anglePen :  (nEvents,) float 
rawS2DataToFitAng_anglePen :  (nEvents,) float 
rawS2likeDataToFitAng_anglePen :  (nEvents,) float 

#RQs about point statistics (no fits required)
avgPointDistS2Corr :  (nEvents,) float
stdPointDistS2Corr :  (nEvents,) float

avgPointDistS2Raw :  (nEvents,) float
stdPointDistS2Raw :  (nEvents,) float

avgPointDistS2likeRaw :  (nEvents,) float
stdPointDistS2likeRaw :  (nEvents,) float

corrS2Ldata :  (nEvents,) float 
rawS2Ldata :  (nEvents,) float
rawS2likeLdata :  (nEvents,) float

#Comb refers to all the n choose 2 combinations 
#from an event with n pulses
stdCombThetaS2Corr :  (nEvents,) float 
stdCombPhiS2Corr :  (nEvents,) float 

stdPairThetaS2Corr :  (nEvents,) float 
stdPairPhiS2Corr :  (nEvents,) float 

stdCombThetaS2Raw : (nEvents,) float
stdCombPhiS2Raw : (nEvents,) float

stdPairThetaS2Raw :  (nEvents,) float
stdPairPhiS2Raw :  (nEvents,) float

stdCombThetaS2likeRaw : (nEvents,) float
stdCombPhiS2likeRaw : (nEvents,) float

#Pair refers to all the consecutive pulses
stdPairThetaS2likeRaw :  (nEvents,) float
stdPairPhiS2likeRaw :  (nEvents,) float

avgCombThetaS2Corr :  (nEvents,) float 
avgCombPhiS2Corr :  (nEvents,) float 

avgPairThetaS2Corr :  (nEvents,) float 
avgPairPhiS2Corr :  (nEvents,) float 

avgCombThetaS2Raw : (nEvents,) float
avgCombPhiS2Raw : (nEvents,) float

avgPairThetaS2Raw :  (nEvents,) float
avgPairPhiS2Raw :  (nEvents,) float

avgCombThetaS2likeRaw : (nEvents,) float
avgCombPhiS2likeRaw : (nEvents,) float

avgPairThetaS2likeRaw :  (nEvents,) float
avgPairPhiS2likeRaw :  (nEvents,) float

#Anderson-Darling test statistic for Pulse Areas
#each event is compared to a Landau (Moyal) distribution
ADPA_CorrS2_xyz_bot  :  (nEvents,) float
ADPA_CorrS2_xyz  :  (nEvents,) float
ADPA_CorrS2  :  (nEvents,) float
ADPA_RawS2  :  (nEvents,) float
ADPA_RawS2like  :  (nEvents,) float

#number of points outside (bad) and 
#inside (good) different fiducial radii
nBadFiducialCorrS2_18cm :  (nEvents,) float
nBadFiducialCorrS2_20cm :  (nEvents,) float
nGoodFiducialCorrS2_18cm :  (nEvents,) float
nGoodFiducialCorrS2_20cm :  (nEvents,) float

nBadFiducialRawS2_18cm :  (nEvents,) float
nBadFiducialRawS2_20cm :  (nEvents,) float
nGoodFiducialRawS2_18cm :  (nEvents,) float
nGoodFiducialRawS2_20cm :  (nEvents,) float

nBadFiducialRawS2like_18cm :  (nEvents,) float
nBadFiducialRawS2like_20cm :  (nEvents,) float
nGoodFiducialRawS2like_18cm :  (nEvents,) float
nGoodFiducialRawS2like_20cm :  (nEvents,) float

#get the phd/sample for events 
#and various statistics for each event
#for "easy", the pulse areas divided 
#by the number of samples between the 
#start of this pulse and start of the next pulse
#the last pulse is dropped
stdphdpersamp_CorrS2_xyz_bot_easy  :  (nEvents,) float
stdphdpersamp_CorrS2_xyz_easy  :  (nEvents,) float
stdphdpersamp_CorrS2_easy  :  (nEvents,) float
stdphdpersamp_RawS2_easy  :  (nEvents,) float
stdphdpersamp_RawS2like_easy  :  (nEvents,) float

minZScorephdpersamp_CorrS2_xyz_bot_easy  :  (nEvents,) float
minZScorephdpersamp_CorrS2_xyz_easy  :  (nEvents,) float
minZScorephdpersamp_CorrS2_easy  :  (nEvents,) float
minZScorephdpersamp_RawS2_easy  :  (nEvents,) float
minZScorephdpersamp_RawS2like_easy  :  (nEvents,) float

maxZScorephdpersamp_CorrS2_xyz_bot_easy  :  (nEvents,) float
maxZScorephdpersamp_CorrS2_xyz_easy  :  (nEvents,) float
maxZScorephdpersamp_CorrS2_easy  :  (nEvents,) float
maxZScorephdpersamp_RawS2_easy  :  (nEvents,) float
maxZScorephdpersamp_RawS2like_easy  :  (nEvents,) float

#Anderson-Darling test statistic for phd/sample
#using the "easy" method.
#each event is compared to a Landau (Moyal) distribution
ADphdpersamp_CorrS2_xyz_bot_easy  :  (nEvents,) float
ADphdpersamp_CorrS2_xyz_easy  :  (nEvents,) float
ADphdpersamp_CorrS2_easy  :  (nEvents,) float
ADphdpersamp_RawS2_easy  :  (nEvents,) float
ADphdpersamp_RawS2like_easy  :  (nEvents,) float

#for "binned" divide pulse area based on width
# percentage in bin. each event is divided into
# 10 bins, but each event will not have the 
#same bin size, as track lengths through the detector 
#are different for different events
stdphdpersamp_CorrS2_xyz_bot_binned  :  (nEvents,) float
stdphdpersamp_CorrS2_xyz_binned  :  (nEvents,) float
stdphdpersamp_CorrS2_binned  :  (nEvents,) float
stdphdpersamp_RawS2_binned  :  (nEvents,) float
stdphdpersamp_RawS2like_binned  :  (nEvents,) float

minZScorephdpersamp_CorrS2_xyz_bot_binned  :  (nEvents,) float
minZScorephdpersamp_CorrS2_xyz_binned  :  (nEvents,) float
minZScorephdpersamp_CorrS2_binned  :  (nEvents,) float
minZScorephdpersamp_RawS2_binned  :  (nEvents,) float
minZScorephdpersamp_RawS2like_binned  :  (nEvents,) float

maxZScorephdpersamp_CorrS2_xyz_bot_binned  :  (nEvents,) float
maxZScorephdpersamp_CorrS2_xyz_binned  :  (nEvents,) float
maxZScorephdpersamp_CorrS2_binned  :  (nEvents,) float
maxZScorephdpersamp_RawS2_binned  :  (nEvents,) float
maxZScorephdpersamp_RawS2like_binned  :  (nEvents,) float

#Anderson-Darling test statistic for phd/sample from binning
#each event is compared to a Landau (Moyal) distribution
ADphdpersamp_CorrS2_xyz_bot_binned  :  (nEvents,) float
ADphdpersamp_CorrS2_xyz_binned  :  (nEvents,) float
ADphdpersamp_CorrS2_binned  :  (nEvents,) float
ADphdpersamp_RawS2_binned  :  (nEvents,) float
ADphdpersamp_RawS2like_binned :  (nEvents,) float
}

lip_rqs = collections.OrderedDict(dict_lip_rqs)
return lip_rqs
\end{Verbatim}
